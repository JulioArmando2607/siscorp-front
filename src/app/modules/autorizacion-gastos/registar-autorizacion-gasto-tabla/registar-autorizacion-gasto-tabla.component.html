<div class="flex min-w-0 flex-auto flex-col bg-card p-10">

    <!-- Contenedor de título y botón alineados -->
    <div class="flex justify-center relative items-center mb-4">
        <!-- Título centrado -->
        <div class="text-2xl font-bold text-center flex-1">
            REGISTRAR AUTORIZACIÓN DE GASTO {{titulo}}
        </div>
        <!-- Botón de salida alineado a la derecha -->
        <div class="absolute right-0">
            <button mat-flat-button style="background-color: red; color: white;" (click)="salir()">
                <mat-icon>exit_to_app</mat-icon> Salir
            </button>
        </div>
    </div>

    <!-- Tabla de proyectos registrados -->
    <div class="mt-6 border p-4 rounded-lg shadow-lg relative">
        <!-- Contenedor de botones flotantes -->
        <div class="botones-flotantes">

        </div>

        <div class="mb-4 flex justify-end">
            <mat-form-field appearance="outline">
                <mat-label>Buscar recurso</mat-label>
                <input matInput (keyup)="aplicarFiltro($event)" placeholder="Escribe el nombre del recurso">
            </mat-form-field>
        </div>


        <div class="table-container">
            <table mat-table [dataSource]="dataSource" class="mat-table">

                <ng-container matColumnDef="recurso">
                    <mat-header-cell *matHeaderCellDef mat-sort-header> RECURSO </mat-header-cell>
                    <mat-cell *matCellDef="let row"> {{ row.nombreRecurso }} </mat-cell>
                </ng-container>

                <!-- CUI Column -->
                <ng-container matColumnDef="und">
                    <mat-header-cell *matHeaderCellDef mat-sort-header> UND </mat-header-cell>
                    <mat-cell *matCellDef="let row"> {{ row.unidad }} </mat-cell>
                </ng-container>


                <ng-container matColumnDef="monto_total_asignada">
                    <mat-header-cell *matHeaderCellDef mat-sort-header> MONTO TOTAL ASIGNADO</mat-header-cell>
                    <mat-cell *matCellDef="let row"> {{ row.montoAsignado }} </mat-cell>
                </ng-container>
                <!-- Distrito Column -->
                <ng-container matColumnDef="cantidad_total_asignada">
                    <mat-header-cell *matHeaderCellDef mat-sort-header> CANTIDAD TOTAL ASIGNADO</mat-header-cell>
                    <mat-cell *matCellDef="let row"> {{ row.cantidadAsignado }} </mat-cell>
                </ng-container>

                <!-- Distrito Column -->
                <ng-container matColumnDef="monto_restante">
                    <mat-header-cell *matHeaderCellDef mat-sort-header> MONTO TOTAL RESTANTE</mat-header-cell>
                    <mat-cell *matCellDef="let row"> {{ row.montoRestante }} </mat-cell>
                </ng-container>

                <ng-container matColumnDef="cantidad_restante">
                    <mat-header-cell *matHeaderCellDef mat-sort-header> CANTIDAD TOTAL RESTANTE </mat-header-cell>
                    <mat-cell *matCellDef="let row"> {{ cantidadRestante }} </mat-cell>
                </ng-container>

                <!-- cantidad Column -->
                <ng-container matColumnDef="cantidad">
                    <mat-header-cell *matHeaderCellDef mat-sort-header> CANTIDAD </mat-header-cell>
                    <mat-cell *matCellDef="let row; let i = index">
                        <input matInput type="number" [(ngModel)]="row.cantidad" [ngModelOptions]="{standalone: true}">
                    </mat-cell>
                </ng-container>

                <!-- precio_unitario Column  (blur)="recalcularTotal(i)"  -->
                <ng-container matColumnDef="precio_unitario">
                    <mat-header-cell *matHeaderCellDef mat-sort-header> PRECIO UNITARIO </mat-header-cell>
                    <mat-cell *matCellDef="let row; let i = index">
                        <input matInput type="number" [(ngModel)]="row.precio" (blur)="recalcularTotal(i)"
                            [ngModelOptions]="{standalone: true}">
                    </mat-cell>
                </ng-container>

                <ng-container matColumnDef="total_calculado">
                    <mat-header-cell *matHeaderCellDef mat-sort-header> TOTAL CALCULADO </mat-header-cell>
                    <mat-cell *matCellDef="let row; let i = index">
                        <input matInput type="number" [value]="row.total" disabled class="input-total-calculado" />
                    </mat-cell>
                </ng-container>


                <!-- total Column -->
                <ng-container matColumnDef="monto_utilizado">
                    <mat-header-cell *matHeaderCellDef mat-sort-header> MONTO UTILIZADO </mat-header-cell>
                    <mat-cell *matCellDef="let row">
                        {{ row.montoUtilizado | number: '1.2-2' }}
                    </mat-cell>
                </ng-container>
                <!-- total Column -->
                <ng-container matColumnDef="cantidad_utilizado">
                    <mat-header-cell *matHeaderCellDef mat-sort-header> CANTIDAD UTILIZADO </mat-header-cell>
                    <mat-cell *matCellDef="let row">
                        {{ row.montoUtilizado}}
                    </mat-cell>
                </ng-container>



                <ng-container matColumnDef="porcentaje">
                    <mat-header-cell *matHeaderCellDef mat-sort-header> PORCENTAJE %</mat-header-cell>
                    <mat-cell *matCellDef="let row" [ngStyle]="{
                      'font-weight': 'bold',
                      'color': getTextColor(row.colorEstado)
                    }">
                        {{ row.porcentajeUso }} %
                    </mat-cell>
                </ng-container>


                <!-- Botón de acciones -->
                <ng-container matColumnDef="acciones">
                    <mat-header-cell *matHeaderCellDef> Acciones </mat-header-cell>
                    <mat-cell *matCellDef="let row">
                        <!-- Botón Editar  
                 <button mat-icon-button color="primary" (click)="editar(row)" matTooltip="Editar Proyecto">
                  <mat-icon>edit</mat-icon>
              </button>-->

                        <!-- Botón Eliminar -->
                        <button mat-icon-button color="warn" (click)="eliminar(row)" matTooltip="Eliminar Recurso">
                            <mat-icon>delete</mat-icon>
                        </button>


                    </mat-cell>
                </ng-container>

                <!-- Encabezado de la tabla -->
                <thead mat-header-row *matHeaderRowDef="displayedColumns" class="mat-header"></thead>
                <!-- Cuerpo de la tabla con scroll -->
                <tbody mat-row *matRowDef="let row; columns: displayedColumns;"></tbody>

            </table>
        </div>


    </div>

</div>